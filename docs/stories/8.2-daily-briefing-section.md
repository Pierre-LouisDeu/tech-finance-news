# Story 8.2: Daily Briefing Archive Section

## Epic
Epic 8: Daily Digest & Enhanced Reporting

## Description
Cr√©er une section d√©di√©e dans Notion pour archiver les r√©sum√©s quotidiens de l'actualit√© tech/finance. Chaque jour dispose de son propre r√©sum√© synth√©tique, permettant de consulter l'historique et de naviguer facilement entre les jours.

## User Story
**En tant qu'** utilisateur de la veille
**Je veux** une section s√©par√©e regroupant les r√©sum√©s quotidiens
**Afin de** consulter rapidement l'essentiel de chaque journ√©e et naviguer dans l'historique

## Acceptance Criteria
- [x] Base Notion d√©di√©e "Daily Briefings" cr√©√©e (s√©par√©e des articles)
- [x] Chaque entr√©e contient: date, nombre d'articles, r√©sum√© global GPT
- [x] Le r√©sum√© global synth√©tise les 3-5 points cl√©s de la journ√©e
- [x] Liste des articles du jour avec liens vers les pages Notion individuelles
- [x] Navigation chronologique possible (tri par date)
- [x] Tag "Digest" pour diff√©rencier des articles standard
- [x] Pas de duplicate si digest d√©j√† g√©n√©r√© pour le jour

## Technical Notes

### Architecture
```
src/digest/
‚îú‚îÄ‚îÄ index.ts           # Existant - generateDailyDigest, pushDigestToNotion
‚îú‚îÄ‚îÄ briefing.ts        # NOUVEAU - gestion de la section briefing
‚îî‚îÄ‚îÄ queries.ts         # NOUVEAU - requ√™tes DB sp√©cifiques digest
```

### Nouvelle table SQLite
```sql
CREATE TABLE daily_briefings (
  date TEXT PRIMARY KEY,           -- YYYY-MM-DD
  article_count INTEGER NOT NULL,
  global_summary TEXT NOT NULL,
  notion_page_id TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### Configuration Notion
```typescript
// .env
NOTION_BRIEFING_DATABASE_ID=...  // Base s√©par√©e pour les briefings

// Si m√™me base, utiliser property "Type" = "Briefing" vs "Article"
```

### Structure Page Notion Briefing
```
üìä Briefing du 2026-01-09
‚îú‚îÄ‚îÄ Callout: "X articles trait√©s"
‚îú‚îÄ‚îÄ H2: Points cl√©s du jour
‚îÇ   ‚îî‚îÄ‚îÄ R√©sum√© GPT (3-5 bullets)
‚îú‚îÄ‚îÄ Divider
‚îú‚îÄ‚îÄ H2: Articles du jour
‚îÇ   ‚îî‚îÄ‚îÄ Table/Liste avec liens vers articles individuels
‚îî‚îÄ‚îÄ Footer: G√©n√©r√© automatiquement par Tech Finance News
```

### Prompt GPT pour r√©sum√© quotidien
```
Tu es un analyste financier senior. Synth√©tise les actualit√©s tech/finance de la journ√©e.

Format attendu:
- 3 √† 5 points cl√©s maximum
- Style: concis, factuel, orient√© business/investissement
- Mentionner les entreprises et chiffres importants

Articles du jour:
{liste des titres + r√©sum√©s courts}

G√©n√®re un r√©sum√© ex√©cutif de la journ√©e.
```

## Implementation Tasks
1. [x] Ajouter variable env `NOTION_BRIEFING_DATABASE_ID` (optionnel, fallback sur DB principale)
2. [x] Cr√©er table `daily_briefings` dans schema SQLite
3. [x] Impl√©menter `src/digest/briefing.ts` avec:
   - `briefingExists(date: string): boolean`
   - `saveBriefing(briefing: DailyBriefing): void`
   - `createNotionBriefingPage(briefing: DailyBriefing): Promise<string>`
4. [x] Modifier `runDailyDigest` pour utiliser la nouvelle structure
5. [x] Ajouter liens vers articles individuels dans la page briefing
6. [ ] Tester g√©n√©ration sur plusieurs jours (manuel)

## Dependencies
- Story 8.1 (Daily Digest) - COMPLETED
- Story 5.1, 5.2 (Notion Integration) - COMPLETED

## Out of Scope
- Interface web pour consulter les briefings (Notion suffit)
- Notifications push des briefings
- Briefings hebdomadaires/mensuels (future story)

## Estimation
Points: 3

## Definition of Done
- [x] Table `daily_briefings` cr√©√©e et fonctionnelle
- [x] Briefing quotidien visible dans Notion avec structure claire
- [x] Navigation par date possible dans Notion
- [x] Pas de duplicate pour un m√™me jour
- [x] Liens vers articles individuels fonctionnels
- [ ] Tests manuels valid√©s sur 2+ jours
